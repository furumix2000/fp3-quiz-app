Edgeブラウザのタブごとスクリーンショット＆スライドショーアプリ作成手順

プログラミングの知識がなくても大丈夫です。パソコンの操作に慣れていなくても、一つ一つ順番にやっていけば必ず作れますので、一緒に頑張りましょう！

これから、「Edgeブラウザで開いているタブの画面を順番に写真に撮って、その写真を30秒ごとに見せてくれるアプリ」を作っていきます。

まるで魔法の呪文を唱えるように、パソコンに命令を出していくイメージで進めていきましょう。今回は、そのための「Python（パイソン）」という魔法の言葉（プログラミング言語）を使います。

---

### **全体の流れ**

アプリ作りは、大きく分けて4つのステップで進めます。

1.  **準備①：魔法の言葉を使えるようにする（Pythonのインストール）**
2.  **準備②：魔法の力をパワーアップさせる（ライブラリの追加）**
3.  **プログラム作成：パソコンへの命令書を作る**
4.  **実行：アプリを動かしてみる**

---

### **ステップ1：準備① 魔法の言葉を使えるようにする（Pythonのインストール）**

まず、パソコンがPythonという言葉を理解できるように、Pythonをパソコンにインストールします。

1.  **Pythonの公式サイトに行く**
    *   ウェブブラウザ（Edgeで大丈夫です）を開いて、以下の公式サイトにアクセスします。
    *   [https://www.python.org/downloads/](https://www.python.org/downloads/)

2.  **Pythonをダウンロードする**
    *   ページを開くと、**"Download Python 3.x.x"** (xの部分は数字) という黄色いボタンがあります。これをクリックして、インストーラー（インストールするためのファイル）をダウンロードしてください。

3.  **Pythonをインストールする**
    *   ダウンロードしたファイル（`python-3.x.x.exe`のような名前です）を開きます。
    *   インストール画面が出てきたら、**一番下にある「Add Python.exe to PATH」というチェックボックスに、必ずチェックを入れてください。** これにチェックを入れると、どこからでも魔法の呪文を唱えられるようになります。
    *   チェックを入れたら、**「Install Now」** をクリックします。
    *   インストールが終わるまで、しばらく待ちます。「Setup was successful」と表示されたら成功です！「Close」ボタンで閉じてください。

4.  **インストールできたか確認する**
    *   キーボードの「Windowsキー（田）」を押しながら「Rキー」を押してください。「ファイル名を指定して実行」という小さなウィンドウが開きます。
    *   `cmd` と入力して「OK」を押すと、黒い画面（コマンドプロンプト）が開きます。
    *   その黒い画面に、`python --version` と入力して、Enterキーを押してください。
    *   `Python 3.x.x` のようにバージョンが表示されたら、準備はバッチリです！
    *   確認できたら、黒い画面は右上の「×」で閉じてしまって大丈夫です。

---

### **ステップ2：準備② 魔法の力をパワーアップさせる（ライブラリの追加）**

Pythonには、もともと入っている力だけではできないことを可能にする「追加パーツ」のようなものがあります。これを「ライブラリ」と呼びます。今回は2つのライブラリを追加します。

*   `selenium`：ブラウザを自動で動かすためのライブラリ
*   `Pillow`：画像を扱うためのライブラリ

1.  **コマンドプロンプトを開く**
    *   もう一度、キーボードの「Windowsキー」と「Rキー」を同時に押します。
    *   `cmd` と入力して「OK」を押し、黒い画面を開きます。

2.  **ライブラリをインストールする**
    *   黒い画面に、以下の呪文を**1行ずつ**入力して、それぞれEnterキーを押してください。
        *   1行目： `pip install selenium`
        *   （インストールが終わるまで少し待ってから）
        *   2行目： `pip install Pillow`
    *   `Successfully installed...` のようなメッセージが出れば成功です。

---

### **ステップ3：プログラム作成：パソコンへの命令書を作る**

いよいよ、パソコンにやってもらいたいことを書いた「命令書（プログラム）」を作ります。

1.  **Edgeのバージョンに合った「通訳さん」を準備する**
    *   PythonがEdgeブラウザと会話するには、「通訳さん（WebDriver）」が必要です。
    *   **Edgeのバージョンを確認します。**
        *   Edgeブラウザを開きます。
        *   右上の「・・・」をクリックし、「設定」を選びます。
        *   左側のメニューから「Microsoft Edge について」を選びます。
        *   「バージョン xx.x.xxxx.xx」という数字が表示されるので、最初の「xx」の部分（例：127）を覚えておいてください。
    *   **通訳さんをダウンロードします。**
        *   こちらのページにアクセスします： [https://developer.microsoft.com/ja-jp/microsoft-edge/tools/webdriver/](https://developer.microsoft.com/ja-jp/microsoft-edge/tools/webdriver/)
        *   ページの中に、先ほど覚えたバージョンと同じ数字が書かれた場所を探します。（例：バージョンが127なら「127」のセクション）
        *   「x64」と書かれたところのダウンロードリンクをクリックして、ファイルをダウンロードします。
    *   **通訳さんを解凍（展開）します。**
        *   ダウンロードしたファイルは圧縮されている（zip形式）ので、右クリックして「すべて展開」を選びます。
        *   展開して出てきた `msedgedriver.exe` というファイルを、デスクトップなど、分かりやすい場所に置いておいてください。**この後作るプログラムファイルと、この通訳さんファイルは、同じフォルダに置くのが一番簡単です。**

2.  **命令書（プログラム）を書く**
    *   今回は、2つのプログラムを作ります。
        *   `capture.py`：スクリーンショットを撮るプログラム
        *   `slideshow.py`：スライドショーをするプログラム

    *   **プログラムを保存するフォルダを作りましょう。**
        *   デスクトップで右クリック → 「新規作成」 → 「フォルダー」を選び、「EdgeApp」のような分かりやすい名前を付けます。
        *   この「EdgeApp」フォルダの中に、先ほどダウンロードして解凍した `msedgedriver.exe` を移動させてください。
        *   また、スクリーンショットを保存するためのフォルダも作っておきましょう。「EdgeApp」フォルダの中に、さらに「screenshots」という名前のフォルダを作ってください。

    *   **メモ帳を開きます。**
        *   Windowsのスタートメニューから「メモ帳」を探して開きます。

    *   **1つ目のプログラム `capture.py` を作る**
        *   以下のコードをすべてコピーして、メモ帳に貼り付けてください。

        '''python
        import time
        from selenium import webdriver
        from selenium.webdriver.edge.service import Service

        # --- 設定 ---
        # Edgeの通訳さん（msedgedriver.exe）の場所を指定
        # このファイルと同じフォルダに置いた場合は、このままでOK
        DRIVER_PATH = './msedgedriver.exe'

        # スクリーンショットを保存するフォルダ名
        SAVE_FOLDER = 'screenshots'
        # ----------------

        # Edgeを起動する準備
        service = Service(executable_path=DRIVER_PATH)
        driver = webdriver.Edge(service=service)

        print("Edgeブラウザを開きました。")
        print("スクリーンショットを撮りたいタブを全て開いて、準備ができたらこの黒い画面でEnterキーを押してください...")
        input() # ユーザーがEnterキーを押すまで待つ

        # 開いているすべてのタブの情報を取得
        all_tabs = driver.window_handles
        print(f"{len(all_tabs)}個のタブが見つかりました。")

        # 各タブのスクリーンショットを撮る
        for i, tab in enumerate(all_tabs):
            try:
                # タブを切り替え
                driver.switch_to.window(tab)
                time.sleep(1) # ページが読み込まれるのを少し待つ

                # ファイル名を決める (例: screenshot_1.png)
                filename = f"{SAVE_FOLDER}/screenshot_{i + 1}.png"

                # スクリーンショットを撮って保存
                driver.save_screenshot(filename)
                print(f"タブ{i + 1}のスクリーンショットを保存しました: {filename}")

            except Exception as e:
                print(f"タブ{i + 1}の撮影中にエラーが起きました: {e}")

        # ブラウザを閉じる
        driver.quit()
        print("全ての撮影が終わったので、ブラウザを閉じました。")
        '''

    *   **ファイルを保存します。**
        *   メモ帳の「ファイル」メニューから「名前を付けて保存」を選びます。
        *   保存場所に、先ほど作った「EdgeApp」フォルダを指定します。
        *   **「ファイルの種類」を「すべてのファイル」に変更します。**
        *   **「ファイル名」に `capture.py` と入力して**、保存します。

    *   **2つ目のプログラム `slideshow.py` を作る**
        *   もう一度、新しいメモ帳を開きます。
        *   以下のコードをすべてコピーして、貼り付けてください。

        '''python
        import os
        import tkinter as tk
        from PIL import Image, ImageTk
        import glob

        # --- 設定 ---
        # 画像が保存されているフォルダ
        IMAGE_FOLDER = 'screenshots'
        # 画像を切り替える時間（ミリ秒単位。30秒 = 30000）
        SLIDESHOW_DELAY = 30000
        # ----------------

        class Slideshow(tk.Tk):
            def __init__(self, image_files):
                super().__init__()
                self.title("スライドショー")
                self.geometry("800x600") # ウィンドウの大きさ

                self.image_files = image_files
                self.current_image_index = 0

                if not self.image_files:
                    print("画像が見つかりません。")
                    self.destroy()
                    return

                self.label = tk.Label(self)
                self.label.pack(expand=True, fill="both")

                self.show_image()

            def show_image(self):
                # 画像ファイルを開く
                image_path = self.image_files[self.current_image_index]
                pil_image = Image.open(image_path)

                # ウィンドウサイズに合わせて画像サイズを調整
                w, h = self.winfo_width(), self.winfo_height()
                pil_image.thumbnail((w, h), Image.Resampling.LANCZOS)

                # 表示用の画像に変換
                tk_image = ImageTk.PhotoImage(pil_image)

                self.label.config(image=tk_image)
                self.label.image = tk_image # 参照を保持

                # 次の画像へ
                self.current_image_index = (self.current_image_index + 1) % len(self.image_files)

                # 次のタイマーをセット
                self.after(SLIDESHOW_DELAY, self.show_image)

        if __name__ == "__main__":
            # 画像フォルダからpngファイルの一覧を取得
            image_list = glob.glob(f"{IMAGE_FOLDER}/*.png")
            image_list.sort() # ファイルを順番通りに並べる

            if image_list:
                app = Slideshow(image_list)
                app.mainloop()
            else:
                print(f"'{IMAGE_FOLDER}' フォルダにスクリーンショットがありません。")
                print("まず capture.py を実行して、スクリーンショットを撮ってください。")

        '''

    *   **ファイルを保存します。**
        *   先ほどと同じように、「EdgeApp」フォルダの中に、**ファイルの種類を「すべてのファイル」**にして、**ファイル名を `slideshow.py`** として保存します。

---

### **ステップ4：実行：アプリを動かしてみる**

これで全ての準備が整いました！実際にアプリを動かしてみましょう。

1.  **コマンドプロンプトで作業場所に移動する**
    *   コマンドプロンプト（黒い画面）を開きます。
    *   `cd Desktop/EdgeApp` と入力してEnterキーを押します。（デスクトップにEdgeAppフォルダを作った場合）
        *   `cd` は「その場所に移動する」という命令です。

2.  **スクリーンショットを撮る**
    *   まず、手動でEdgeブラウザを開き、スクリーンショットを撮りたいウェブページを、好きなだけタブで開いておきます。
    *   準備ができたら、コマンドプロンプトに `python capture.py` と入力してEnterキーを押します。
    *   すると、自動で新しいEdgeウィンドウが開きます。
    *   黒い画面に「準備ができたらこの黒い画面でEnterキーを押してください...」と表示されたら、**手動で開いていたウィンドウから、自動で開いた新しいウィンドウに、撮りたいタブをドラッグ＆ドロップで移動させてください。**
    *   タブの移動が終わったら、黒い画面をクリックして選択状態にしてから、Enterキーを押します。
    *   自動でタブが切り替わりながら、順番にスクリーンショットが撮影されます。「EdgeApp」フォルダの中の「screenshots」フォルダに、画像が保存されていくのが確認できるはずです。
    *   撮影が終わると、自動で開いたEdgeウィンドウは閉じられます。

3.  **スライドショーを開始する**
    *   スクリーンショットが撮れたら、コマンドプロンプトに `python slideshow.py` と入力してEnterキーを押します。
    *   新しいウィンドウが開き、先ほど撮ったスクリーンショットが30秒ごとに切り替わって表示されます！
    *   スライドショーを終わりたいときは、表示されているウィンドウの右上の「×」ボタンを押してください。

---

### **まとめ**

これであなただけのオリジナルアプリの完成です！

もし、うまくいかないことがあっても、慌てなくて大丈夫です。エラーメッセージをよく読んだり、手順をもう一度見直したりしてみてください。プログラミングは、試行錯誤の連続です。

このプログラムを改造して、例えばスライドショーの時間を10秒に変えたい場合は、`slideshow.py` の中の `SLIDESHOW_DELAY = 30000` の数字を `10000` に変えるだけで変更できます。

ぜひ、色々と試して楽しんでみてください！
